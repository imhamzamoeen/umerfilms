# Story 4.8: Install Swiper.js & Portfolio Slider

## Status
Draft

## Story
**As a** visitor,
**I want** the portfolio section to use a slider instead of static grid,
**so that** I can browse projects with smooth animations.

## Acceptance Criteria

1. Swiper.js installed (`npm install swiper`)
2. PortfolioSlider component created using Swiper
3. Multiple projects per view (3 on desktop, 2 on tablet, 1 on mobile)
4. Each slide shows project image with overlay (title + category)
5. Pagination bullets with purple-pink active state
6. Navigation arrows visible on hover
7. Smooth transitions (0.4s ease-out)
8. Clicking project opens lightbox (Story 4.9 dependency)
9. Swiper configuration optimized for performance
10. Component tests verify slider functionality
11. Keyboard navigation supported (arrow keys)
12. Touch/swipe gestures work on mobile

## Tasks / Subtasks

- [ ] Task 1: Install Swiper.js (AC: 1)
  - [ ] Run `npm install swiper`
  - [ ] Import Swiper CSS in globals.css or layout
  - [ ] Verify installation successful
  - [ ] Check Swiper version (latest)

- [ ] Task 2: Create PortfolioSlider Component (AC: 2, 3)
  - [ ] Create `src/components/home/PortfolioSlider.tsx`
  - [ ] Import Swiper and required modules
  - [ ] Configure slidesPerView (1 mobile, 2 tablet, 3 desktop)
  - [ ] Set up responsive breakpoints
  - [ ] Map over projects data

- [ ] Task 3: Style Portfolio Slides (AC: 4)
  - [ ] Display project image as background
  - [ ] Add dark overlay on hover
  - [ ] Show project title and category on overlay
  - [ ] Use purple-pink gradient for overlay
  - [ ] Add smooth transitions

- [ ] Task 4: Configure Pagination (AC: 5)
  - [ ] Enable Swiper pagination
  - [ ] Style bullets with purple-pink active state
  - [ ] Position bullets below slider
  - [ ] Make bullets clickable
  - [ ] Test pagination navigation

- [ ] Task 5: Add Navigation Arrows (AC: 6)
  - [ ] Enable Swiper navigation
  - [ ] Style prev/next arrows
  - [ ] Show arrows on hover only
  - [ ] Position arrows on sides of slider
  - [ ] Apply purple-pink gradient to arrows

- [ ] Task 6: Configure Transitions (AC: 7)
  - [ ] Set transition speed to 400ms
  - [ ] Use ease-out easing
  - [ ] Test slide smoothness
  - [ ] Optimize for 60fps

- [ ] Task 7: Add Click to Open Lightbox (AC: 8)
  - [ ] Add onClick handler to slides
  - [ ] Pass project data to handler
  - [ ] Prepare for lightbox integration (Story 4.9)
  - [ ] Add cursor pointer on hover

- [ ] Task 8: Performance Optimization (AC: 9)
  - [ ] Enable lazy loading for images
  - [ ] Set preload images to 2-3 slides
  - [ ] Use next/image for optimization
  - [ ] Test performance on low-end devices

- [ ] Task 9: Keyboard & Touch Navigation (AC: 11, 12)
  - [ ] Enable keyboard control in Swiper config
  - [ ] Test arrow key navigation
  - [ ] Verify touch/swipe gestures work
  - [ ] Test on mobile devices

- [ ] Task 10: Component Testing (AC: 10)
  - [ ] Create `PortfolioSlider.test.tsx`
  - [ ] Test slider renders
  - [ ] Test navigation arrows work
  - [ ] Test pagination works
  - [ ] Mock Swiper for tests

## Dev Notes

### Swiper.js Specification
[Source: idea.md - Interactive components section, changes.md section 8]

**From idea.md:**
- Portfolio implemented with Swiper slider
- Multiple projects per view (responsive)
- Pagination bullets with purple-pink active state
- Smooth transitions (0.4s ease-out)
- Clicking project opens lightbox

**Installation:**
```bash
npm install swiper
```

**Current Implementation:**
- Static grid of portfolio cards
- No slider functionality

### PortfolioSlider Component
[Source: docs/architecture/unified-project-structure.md]

**File:** `src/components/home/PortfolioSlider.tsx`

```tsx
'use client';

import { Swiper, SwiperSlide } from 'swiper/react';
import { Navigation, Pagination, Keyboard, A11y } from 'swiper/modules';
import Image from 'next/image';
import { projects } from '@/data/projects';

// Import Swiper styles
import 'swiper/css';
import 'swiper/css/navigation';
import 'swiper/css/pagination';

interface PortfolioSliderProps {
  onProjectClick?: (projectId: string) => void;
}

export default function PortfolioSlider({ onProjectClick }: PortfolioSliderProps) {
  return (
    <section className="portfolio-slider bg-black py-24">
      <div className="container mx-auto px-6">
        {/* Section Header */}
        <div className="mb-16 text-center">
          <p className="section-label mb-4 text-sm uppercase tracking-widest text-gray-400">
            Portfolio
          </p>
          <h2 className="text-5xl font-bold text-white md:text-6xl">
            Featured Work
          </h2>
        </div>

        {/* Swiper Slider */}
        <Swiper
          modules={[Navigation, Pagination, Keyboard, A11y]}
          spaceBetween={30}
          slidesPerView={1}
          navigation
          pagination={{ clickable: true }}
          keyboard={{ enabled: true }}
          speed={400}
          breakpoints={{
            768: {
              slidesPerView: 2,
              spaceBetween: 30,
            },
            1024: {
              slidesPerView: 3,
              spaceBetween: 40,
            },
          }}
          className="portfolio-swiper"
        >
          {projects.map((project) => (
            <SwiperSlide key={project.id}>
              <div
                className="portfolio-slide group relative aspect-video cursor-pointer overflow-hidden rounded-lg"
                onClick={() => onProjectClick?.(project.id)}
              >
                {/* Project Image */}
                <Image
                  src={project.thumbnail}
                  alt={project.title}
                  fill
                  className="object-cover transition-transform duration-500 group-hover:scale-110"
                />

                {/* Overlay */}
                <div className="absolute inset-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100">
                  <div className="absolute bottom-0 left-0 right-0 p-6">
                    <p className="text-sm uppercase tracking-wider text-gray-300">
                      {project.category}
                    </p>
                    <h3 className="mt-2 text-2xl font-bold text-white">
                      {project.title}
                    </h3>
                  </div>
                </div>
              </div>
            </SwiperSlide>
          ))}
        </Swiper>
      </div>
    </section>
  );
}
```

### Swiper Configuration
[Source: Swiper.js documentation]

**Responsive Breakpoints:**
```javascript
breakpoints: {
  // Mobile: 1 slide
  320: {
    slidesPerView: 1,
    spaceBetween: 20,
  },
  // Tablet: 2 slides
  768: {
    slidesPerView: 2,
    spaceBetween: 30,
  },
  // Desktop: 3 slides
  1024: {
    slidesPerView: 3,
    spaceBetween: 40,
  },
}
```

**Required Modules:**
- Navigation: Prev/next arrows
- Pagination: Bullets
- Keyboard: Arrow key navigation
- A11y: Accessibility features

### Custom Swiper Styles
[Source: idea.md - Colour palette section]

**Add to globals.css:**

```css
/* Swiper Navigation Arrows */
.swiper-button-next,
.swiper-button-prev {
  color: #ffffff;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.portfolio-swiper:hover .swiper-button-next,
.portfolio-swiper:hover .swiper-button-prev {
  opacity: 1;
}

.swiper-button-next:hover,
.swiper-button-prev:hover {
  background: linear-gradient(135deg, #450e93 0%, #d5007f 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

/* Swiper Pagination Bullets */
.swiper-pagination-bullet {
  background: #ffffff;
  opacity: 0.5;
  width: 12px;
  height: 12px;
}

.swiper-pagination-bullet-active {
  background: linear-gradient(135deg, #450e93 0%, #d5007f 100%);
  opacity: 1;
  width: 32px;
  border-radius: 6px;
}

/* Portfolio Slide */
.portfolio-slide {
  position: relative;
  border-radius: 0.5rem;
  overflow: hidden;
}

.portfolio-slide img {
  transition: transform 0.5s ease;
}

.portfolio-slide:hover img {
  transform: scale(1.1);
}
```

### Image Optimization
[Source: idea.md - Technical fidelity section]

**Use Next.js Image:**
```tsx
<Image
  src={project.thumbnail}
  alt={project.title}
  fill
  sizes="(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw"
  className="object-cover"
  loading="lazy"
/>
```

**Lazy Loading:**
```javascript
// Swiper config
lazy: {
  loadPrevNext: true,
  loadPrevNextAmount: 2,
}
```

### Overlay Design
[Source: idea.md - Colour palette, Animations sections]

**Gradient Overlay:**
- Background: Gradient from black (bottom) to transparent (top)
- Opacity: 0 by default, 100 on hover
- Transition: 0.3s ease
- Content: Title, category at bottom

**Implementation:**
```tsx
<div className="overlay absolute inset-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300">
  <div className="content absolute bottom-0 p-6">
    <p className="category">{project.category}</p>
    <h3 className="title">{project.title}</h3>
  </div>
</div>
```

### Keyboard Navigation
[Source: idea.md - Semantic & accessible section]

**Swiper Keyboard Module:**
```javascript
keyboard: {
  enabled: true,
  onlyInViewport: true,
}
```

**Keyboard Controls:**
- Arrow Left: Previous slide
- Arrow Right: Next slide
- Arrow Up: Previous slide
- Arrow Down: Next slide

### Touch/Swipe Gestures
[Source: idea.md - Interactive components section]

**Swiper Touch Config:**
```javascript
touchRatio: 1,
touchAngle: 45,
grabCursor: true,
```

**Mobile Optimizations:**
- Swipe sensitivity adjusted
- Grab cursor indicates draggable
- Touch-friendly navigation

### Component Testing
[Source: docs/architecture/testing-strategy.md]

**Test File:** `src/components/home/PortfolioSlider.test.tsx`

```typescript
import { render, screen } from '@testing-library/react';
import { describe, it, expect, vi } from 'vitest';
import PortfolioSlider from './PortfolioSlider';
import { projects } from '@/data/projects';

// Mock Swiper components
vi.mock('swiper/react', () => ({
  Swiper: ({ children }: any) => <div data-testid="swiper">{children}</div>,
  SwiperSlide: ({ children }: any) => <div data-testid="swiper-slide">{children}</div>,
}));

describe('PortfolioSlider', () => {
  it('renders all project slides', () => {
    render(<PortfolioSlider />);

    projects.forEach((project) => {
      expect(screen.getByText(project.title)).toBeInTheDocument();
    });
  });

  it('calls onProjectClick when slide clicked', () => {
    const handleClick = vi.fn();
    render(<PortfolioSlider onProjectClick={handleClick} />);

    const firstSlide = screen.getByText(projects[0].title).closest('.portfolio-slide');
    firstSlide?.click();

    expect(handleClick).toHaveBeenCalledWith(projects[0].id);
  });

  it('renders section heading', () => {
    render(<PortfolioSlider />);
    expect(screen.getByRole('heading', { name: /featured work/i })).toBeInTheDocument();
  });
});
```

### Dependencies
[Source: Epic 4 definition]

**Story Dependencies:**
- Depends on Story 4.1 (color palette) for gradient styling
- Dependency for Story 4.9 (lightbox) - provides onClick handler
- Should be implemented after Story 4.7 (timeline)

**Package Dependencies:**
```bash
npm install swiper
```

### Integration with Lightbox
[Source: Epic 4, Story 4.9]

**Prepare for Lightbox:**
```tsx
const [selectedProject, setSelectedProject] = useState<string | null>(null);

const handleProjectClick = (projectId: string) => {
  setSelectedProject(projectId);
  // Story 4.9 will open lightbox here
};

<PortfolioSlider onProjectClick={handleProjectClick} />
```

### Performance Considerations
[Source: idea.md - Technical fidelity section]

**Optimizations:**
- Lazy load images outside viewport
- Preload 2-3 slides ahead
- Use next/image for automatic optimization
- Disable autoplay to save resources
- CSS will-change for smooth animations

### Accessibility
[Source: idea.md - Semantic & accessible section]

**A11y Features:**
- Keyboard navigation enabled
- ARIA labels for navigation
- Focus indicators on slides
- Alt text on all images
- Semantic HTML structure

### Implementation Order
1. ✅ Install Swiper.js
2. ✅ Create PortfolioSlider component
3. ✅ Configure responsive breakpoints
4. ✅ Style slides with overlays
5. ✅ Add navigation and pagination
6. ✅ Apply purple-pink gradient styling
7. ✅ Add keyboard/touch support
8. ✅ Write component tests

## Testing

[Source: docs/architecture/testing-strategy.md]

**Test Types:**
1. **Component Tests:** Rendering, navigation, click handlers
2. **Visual Tests:** Slider transitions, hover effects
3. **Responsive Tests:** Breakpoints, slide counts

**Test Commands:**
```bash
npm test                          # Run all tests
npm test PortfolioSlider.test     # Test slider
```

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-14 | 1.0 | Initial story draft | Claude |

## Dev Agent Record

### Agent Model Used
_To be filled by dev agent_

### Debug Log References
_To be filled by dev agent_

### Completion Notes List
_To be filled by dev agent_

### File List
_To be filled by dev agent_

## QA Results
_To be filled by QA agent after implementation_
